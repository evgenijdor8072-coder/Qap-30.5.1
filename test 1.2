class TestUserPetsTable:
    
    def test_all_pets_in_table(self, driver):
        """Для табличной структуры."""
        WebDriverWait(driver, 10).until(
            EC.presence_of_element_located((By.CSS_SELECTOR, "table"))
        )
        
        rows = driver.find_elements(By.CSS_SELECTOR, "table tbody tr")
        
        assert len(rows) > 0
        
        photos = driver.find_elements(By.CSS_SELECTOR, "table tbody tr td:nth-child(1) img")
        valid_photos = [p for p in photos if p.get_attribute("src") and "placeholder" not in p.get_attribute("src")]
        assert len(valid_photos) >= len(rows) / 2
        
        names, ages, breeds = [], [], []
        for row in rows:
            cols = row.find_elements(By.TAG_NAME, "td")
            names.append(cols[1].text.strip())
            ages.append(cols[2].text.strip())
            breeds.append(cols[3].text.strip())
            
            assert cols[1].text.strip() != ""
            assert cols[2].text.strip() != ""
            assert cols[3].text.strip() != ""
        
        assert len(names) == len(set(names))
        
        pets_set = set(zip(names, ages, breeds))
        assert len(pets_set) == len(rows), "Есть повторяющиеся питомцы"
